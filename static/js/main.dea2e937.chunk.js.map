{"version":3,"sources":["App.js","index.js","environment.js","contexts/index.js"],"names":["pages","Map","React","lazy","App","useState","name","params","page","setPage","data","localStorage","getItem","GOOGLE_AUTH_RESPONSE_KEY","JSON","parse","e","loadAuthFromLocal","auth","pageContextValue","authContextValue","setAuth","PageComponent","has","get","Provider","value","fallback","ReactDOM","render","StrictMode","document","getElementById","GOOGLE_CLIENT_ID","GOOGLE_SCOPE","PageContext","createContext","usePage","useContext","AuthContext","useAuth","authReloader","setAuthReloader","authReload","useCallback","a","setItem","stringify","signIn","useGoogleLogin","onSuccess","response","getAuthResponse","reloadAuthResponse","clientId","scope","signOut","useGoogleLogout","undefined","removeItem","onFailure","res","console","log","useEffect","expires_at","Date","getTime"],"mappings":"6LAOMA,EAAQ,IAAIC,IAAI,CACpB,CAAC,OAJUC,IAAMC,MAAK,kBAAM,uDAK5B,CAAC,QAJWD,IAAMC,MAAK,kBAAM,iCAK7B,CAAC,QAJWD,IAAMC,MAAK,kBAAM,yDA4ChBC,MA1Bf,WACE,MAAwBC,mBAAS,CAAEC,KAAM,OAAQC,OAAQ,KAAzD,mBAAOC,EAAP,KAAaC,EAAb,KACA,EAAwBJ,mBAX1B,WACE,IACE,IAAMK,EAAOC,aAAaC,QAAQC,KAClC,OAAOC,KAAKC,MAAML,GAClB,MAAOM,GACP,QAM+BC,IAAjC,mBAAOC,EAAP,KACMC,EAAmB,CACvBV,UACAD,QAEIY,EAAmB,CACvBC,QANF,KAOEH,QAEII,EAAgBtB,EAAMuB,IAAIf,EAAKF,MACjCN,EAAMwB,IAAIhB,EAAKF,MACfN,EAAMwB,IAxBS,QA0BnB,OACE,cAAC,IAAYC,SAAb,CAAsBC,MAAOP,EAA7B,SACE,cAAC,IAAYM,SAAb,CAAsBC,MAAON,EAA7B,SACE,cAAC,WAAD,CAAUO,SAAU,6CAApB,SACE,cAACL,EAAD,WCvCVM,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,U,kQCRbC,EACX,2EAEWC,EACX,yDCAWC,EAAcjC,IAAMkC,cAAc,MAClCC,EAAU,kBAAMC,qBAAWH,IAE3BtB,EAA2B,qBAC3B0B,EAAcrC,IAAMkC,cAAc,MAClCI,EAAU,WACrB,MAA0BF,qBAAWC,GAA7BlB,EAAR,EAAQA,QAASH,EAAjB,EAAiBA,KACjB,EAAwCb,qBAAxC,mBAAOoC,EAAP,KAAqBC,EAArB,KAEMC,EAAaC,sBAAW,sBAAC,4BAAAC,EAAA,0DACzBJ,EADyB,gCAERA,IAFQ,cAErB/B,EAFqB,OAG3BC,aAAamC,QAAQjC,EAA0BC,KAAKiC,UAAUrC,IAC9DW,EAAQX,GAJmB,kBAKpBA,GALoB,2CAO5B,CAAC+B,EAAcpB,IAEV2B,EAAWC,yBAAe,CAChCC,UAAW,SAACC,GACV,IAAMzC,EAAOyC,EAASC,kBACtBzC,aAAamC,QAAQjC,EAA0BC,KAAKiC,UAAUrC,IAC9DW,EAAQX,GACRgC,EAAgBS,EAASE,qBAE3BC,SAAUrB,EACVsB,MAAOrB,IARDc,OAWAQ,EAAYC,0BAAgB,CAClCP,UAAW,WACT7B,OAAQqC,GACR/C,aAAagD,WAAW9C,IAE1B+C,UAAW,SAACC,GACVC,QAAQC,IAAI,eACZD,QAAQC,IAAIF,IAEdP,SAAUrB,EACVsB,MAAOrB,IAVDsB,QAmBR,OANAQ,qBAAU,aACH9C,GAAQA,EAAK+C,YAAa,IAAIC,MAAOC,YACxCnB,MAED,CAAC9B,EAAM8B,IAEH,CACL9B,OACAsC,UACAb,iB","file":"static/js/main.dea2e937.chunk.js","sourcesContent":["import React, { useState, Suspense } from \"react\";\nimport { PageContext, AuthContext, GOOGLE_AUTH_RESPONSE_KEY } from \"./contexts\";\nimport \"./App.scss\";\n\nconst Home = React.lazy(() => import(\"./pages/Home\"));\nconst Login = React.lazy(() => import(\"./pages/Login\"));\nconst Album = React.lazy(() => import(\"./pages/Album\"));\nconst pages = new Map([\n  [\"home\", Home],\n  [\"login\", Login],\n  [\"album\", Album],\n]);\n\nconst DEFAULT_PAGE = \"home\";\n\nfunction loadAuthFromLocal() {\n  try {\n    const data = localStorage.getItem(GOOGLE_AUTH_RESPONSE_KEY);\n    return JSON.parse(data);\n  } catch (e) {\n    return undefined;\n  }\n}\n\nfunction App() {\n  const [page, setPage] = useState({ name: \"home\", params: {} });\n  const [auth, setAuth] = useState(loadAuthFromLocal());\n  const pageContextValue = {\n    setPage,\n    page,\n  };\n  const authContextValue = {\n    setAuth,\n    auth,\n  };\n  const PageComponent = pages.has(page.name)\n    ? pages.get(page.name)\n    : pages.get(DEFAULT_PAGE);\n\n  return (\n    <PageContext.Provider value={pageContextValue}>\n      <AuthContext.Provider value={authContextValue}>\n        <Suspense fallback={<div>Loading...</div>}>\n          <PageComponent />\n        </Suspense>\n      </AuthContext.Provider>\n    </PageContext.Provider>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n","export const GOOGLE_CLIENT_ID =\n  \"488762331302-o2knjrrhfk1bc4f5fecusvaod97uosdt.apps.googleusercontent.com\";\n\nexport const GOOGLE_SCOPE =\n  \"https://www.googleapis.com/auth/photoslibrary.readonly\";\n","import React, { useContext, useEffect, useState, useCallback } from \"react\";\nimport { useGoogleLogin, useGoogleLogout } from \"react-google-login\";\nimport { GOOGLE_SCOPE, GOOGLE_CLIENT_ID } from \"../environment\";\n\nexport const PageContext = React.createContext(null);\nexport const usePage = () => useContext(PageContext);\n\nexport const GOOGLE_AUTH_RESPONSE_KEY = \"googleAuthResponse\";\nexport const AuthContext = React.createContext(null);\nexport const useAuth = () => {\n  const { setAuth, auth } = useContext(AuthContext);\n  const [authReloader, setAuthReloader] = useState();\n\n  const authReload = useCallback(async () => {\n    if (authReloader) {\n      const data = await authReloader();\n      localStorage.setItem(GOOGLE_AUTH_RESPONSE_KEY, JSON.stringify(data));\n      setAuth(data);\n      return data;\n    }\n  }, [authReloader, setAuth]);\n\n  const { signIn } = useGoogleLogin({\n    onSuccess: (response) => {\n      const data = response.getAuthResponse();\n      localStorage.setItem(GOOGLE_AUTH_RESPONSE_KEY, JSON.stringify(data));\n      setAuth(data);\n      setAuthReloader(response.reloadAuthResponse);\n    },\n    clientId: GOOGLE_CLIENT_ID,\n    scope: GOOGLE_SCOPE,\n  });\n\n  const { signOut } = useGoogleLogout({\n    onSuccess: () => {\n      setAuth(undefined);\n      localStorage.removeItem(GOOGLE_AUTH_RESPONSE_KEY);\n    },\n    onFailure: (res) => {\n      console.log(\"logout fail\");\n      console.log(res);\n    },\n    clientId: GOOGLE_CLIENT_ID,\n    scope: GOOGLE_SCOPE,\n  });\n\n  useEffect(() => {\n    if (!auth || auth.expires_at < new Date().getTime()) {\n      signIn();\n    }\n  }, [auth, signIn]);\n\n  return {\n    auth,\n    signOut,\n    authReload,\n  };\n};\n"],"sourceRoot":""}